A következő erősen messze van a Nirvánától, de működőképesnek tűnik és alapvetően a Chaum-féle DigiCasht húzza rá az openCBDC-re.
A user költeni akar, B pedig fogadni. A blind signature-rel aláírattat a FED-del egy (forráscím,összeg) cetlit, B pedig egy (célcím, összeg) cetlit. Mindkét cetlinek van egy timestamp lejárati ideje (mondjuk 5 perc), eddig, illetve amíg nem történt meg a protokoll végén az elszámolás, nem kapnak újat. VC-vel azonosítják magukat. A FED minden VC-hez tárol egy (garbage+balance) hash-t is; csak akkor ad ki fogadó cetlit, ha a fogadó ZKP tudja bizonyítani, hogy ezzel nem lesz túl sok pénze. (Itt lyukas most a dolog, mert erre nincs most implementáció a kezünkben, úgyhogy erre alternatíva kell, lásd lent.)
A odaadja a cetlijét B-nek és egy normál aláírt openCBDC tranzakció-kérést.
B megy a sentinelhez, bemutatja a két cetlit és a tranzakciót. Ha az összegek és a lejárati idők jók, akkor a sentinel elvégzi a tranzakciót és az openCBDC protokollon túl B-nek digitálisan aláírva visszaadja a (forráscím,összeg,timestamp) párt és a (célcím,összeg,timestamp) párt.
B odaadja a digitálisan aláírt (forráscím,összeg,timestamp) doksit A-nak. Mindketten küldenek egy kérést a FED-nek, hogy a VC-jükhöz rendelt hash-t update-elje, ZKP bizonyítva, hogy van egy sentinel által aláírt doksijuk, amiben jó a timestamp és annak megfelelő a hash update. (Na ezt tudjuk, hogyan kell ZoKrates-ben csinálni.) Ide lehet betenni egy olyat, hogy a fogadó azt is bizonyítja, hogy ne legyen így túl sok pénze.
Ez kábé a happy path, a ki kivel hogyan tolhat ki (A és B) kérdést még végig kell gondolni. Annyiban mindenképp jó, hogy ha hibás, max az “encumbrance”-t veszítjük, az openCBDC tulajdonságai maradnak. A túl sok pénzt megoldja, a pénzsebességet, ha baltával is, de megoldja. Abban bízhatunk, hogy a FED-nek és a sentineleknek is van pontos órája. Alapvetően B tudhat szemétkedni A-val itt, ezt kell meggondolni, meg hogy A címét el lehet-e rejteni B elől (utóbbi nem nagyon fontos).
Ezt egyébként “zárásnak” gondolom, az első felének mindenképp egy “vanilla” SSI és openCBDC összekötésnek kellene lennie.